import subprocess
import json


def run_semgrep(path):
    try:
        result = subprocess.run(
            ["semgrep", "--config=auto", "--json", path],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            check=True
        )
        return json.loads(result.stdout.decode())
    except subprocess.CalledProcessError as e:
        print("Error running semgrep:", e.stderr.decode())
        return {}
